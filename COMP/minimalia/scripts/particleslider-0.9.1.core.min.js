// ┌────────────────────────────────────────────────────────────────────┐ \\
// │ ParticleSlider (core module) - B E T A       |       Version 0.9.1 │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Copyright © 2013 Tamino Martinius (http://zaku.eu)                 │ \\
// │ Copyright © 2013 Particleslider.com (http://particleslider.com)    │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Terms of usage: (http://particleslider.com/legal/license)          │ \\
// └────────────────────────────────────────────────────────────────────┘ \\
(function(){var n;n=function(){function n(n){var i,r,u,t;t=this,t.Particle=i=function(){function n(){}return n.prototype.aColor=[0,0,0,0],n.prototype.pNext=null,n.prototype.pPrev=null,n.prototype.iTtl=0,n.prototype.fX=0,n.prototype.fY=0,n.prototype.iGravityX=0,n.prototype.iGravityY=0,n.prototype.fVelocityX=0,n.prototype.fVelocityY=0,n}(),t.ParticleList=r=function(){function n(){}return n.prototype.bIsHightLighted=!1,n.prototype.bIsMonochrome=!1,n.prototype.bKeepOldPosition=!1,n.prototype.bFadeOutOnTtl=!0,n.prototype.iOffsetX=0,n.prototype.iOffsetY=0,n.prototype.iWidth=0,n.prototype.iHeight=0,n.prototype.imgSrc=null,n.prototype.sSrc=null,n.prototype.pFirst=null,n.prototype.plNext=null,n.prototype.plPrev=null,n.prototype.oAnimationOutParams={iAvgTtl:null,bTop:null,bLeft:null,bBottom:null,bRight:null,bUseMinOffset:null,fDisplacement:null,iBaseWidth:null,iBaseHeight:null},n.prototype.oAnimationInParams={iAvgTtl:null,bTop:null,bLeft:null,bBottom:null,bRight:null,bUseMinOffset:null,fDisplacement:null,iBaseWidth:null,iBaseHeight:null,fMaxStartVelocity:5},n.prototype.sAnimationIn="none",n.prototype.sAnimationOut="none",n.prototype.fnAdd=function(n,i){return t.fnSwapList(n,"p",t.Particle,i,this)},n.prototype.fnRemove=function(n,i){return t.fnSwapList(n,"p",t.Particle,this,i)},n.prototype.fnCreate=function(){return t.fnSwapList(t.plDisposed.pFirst,"p",t.Particle,t.plDisposed,this)},n.prototype.fnDispose=function(n){return this.fnRemove(n,t.plDisposed)},n.prototype.fnUpdate=function(){for(t.pTmp=this.pFirst;t.pTmp!=null;)t.pTmpNext=t.pTmp.pNext,t.fnParticleUpdate(),t.pTmp=t.pTmpNext},n.prototype.fnRender=function(){for(this.bIsMonochrome===!0?(t.oRenderWorkingData.bIsMonochrome=!0,t.oRenderWorkingData.aColor=this.bIsHightLighted===!0?t.aColorHighlighted:t.aColorDefault):t.oRenderWorkingData.aColor=null,t.pTmp=this.pFirst;t.pTmp!=null;)t.fnParticleRender(),t.pTmp=t.pTmp.pNext},n.prototype.fnSetImage=function(n){var i;i=this,this.imgSrc=new Image,t.fnAddEventListener(this.imgSrc,"load",function(){i.fnLoadParticleFromImage()}),this.imgSrc.src=n},n.prototype.fnSetText=function(n){this.sSrc=n,this.fnLoadParticlesFromString()},n.prototype.fnLoadParticles=function(n){var t;n!=null||(this.sSrc!=null?this.fnLoadParticlesFromString():this.imgSrc!=null&&this.fnLoadParticlesFromImage()),t=this["fn"+this.sAnimationIn],t!=null&&this["fn"+this.sAnimationIn](this.oAnimationInParams,n)},n.prototype.fnLoadParticlesFromString=function(){var n,r,f,h,u,i,e,o,s,c,l,a;for(t.nCanvLoader.width=this.iWidth=t.iWidth,t.nCanvLoader.height=this.iHeight=t.iHeight,n=this.sSrc.split("\n"),t.ctxLoader.clearRect(0,0,this.iWidth,this.iHeight),r=t.iMaxFontSize,t.ctxLoader.fillStyle="rgba("+t.aColorDefault[0]+","+t.aColorDefault[1]+","+t.aColorDefault[2]+","+t.aColorDefault[3]/255+")",t.ctxLoader.font=r+"px "+t.sFont,e=0,c=n.length;e<c;e++)for(i=n[e];t.ctxLoader.measureText(i).width>this.iWidth;)t.ctxLoader.font=--r+"px "+t.sFont;for(u=0,o=0,l=n.length;o<l;o++)i=n[o],u=Math.max(u,t.ctxLoader.measureText(i).width);for(t.nCanvLoader.width=this.iWidth=u,t.nCanvLoader.height=this.iHeight=~~(r*n.length*(1+t.fLineSpacing)),t.ctxLoader.font=r+"px "+t.sFont,t.ctxLoader.fillStyle="rgba("+t.aColorDefault[0]+","+t.aColorDefault[1]+","+t.aColorDefault[2]+","+t.aColorDefault[3]/255+")",t.ctxLoader.textBaseline="top",f=s=0,a=n.length;s<a;f=++s)i=n[f],h=t.ctxLoader.measureText(i).width,t.ctxLoader.fillText(i,(u-h)/2,~~(f*r*(1+t.fLineSpacing)+t.fLineSpacing/2));this.fnLoadParticlesFromImageData()},n.prototype.fnLoadParticlesFromImage=function(){t.nCanvLoader.width=this.iWidth=this.imgSrc.width,t.nCanvLoader.height=this.iHeight=this.imgSrc.height,t.ctxLoader.clearRect(0,0,this.imgSrc.width,this.imgSrc.height),t.ctxLoader.drawImage(this.imgSrc,0,0),this.fnLoadParticlesFromImageData()},n.prototype.fnLoadParticlesFromImageData=function(){var o,r,n,u,f,h,i,s,e;if(this.iOffsetX=-~~(this.iWidth/2),this.iOffsetY=-~~(this.iHeight/2),i=this.pFirst,s=this.pFirst,this.iWidth>0&&this.iHeight>0)for(h=t.ctxLoader.getImageData(0,0,this.iWidth,this.iHeight),r=h.data,n=0,o=[0,0,0,0],e=null,u=0;u<this.iWidth;){for(f=0;f<this.iHeight;)n=(f*this.iWidth+u)*4,r[n+3]>0&&(o=[r[n+0],r[n+1],r[n+2],r[n+3]],i!=null?(e=i,i=i.pNext):e=this.fnAdd(),t.fnParticleInit(e,u,f,o,this)),f+=t.iPxGap+1;u+=t.iPxGap+1}i!=null?this.fnUnloadParticles(i):s!==this.pFirst&&this.fnLoadParticles(s)},n.prototype.fnUnloadParticles=function(n){var i;if(i=this["fn"+this.sAnimationOut],i!=null)this["fn"+this.sAnimationOut](this.oAnimationOutParams,n);else for(t.pTmp=this.pFirst;t.pTmp!=null;)t.pTmp.iTtl=1,t.pTmp=t.pTmp.pNext},n.prototype.fnRandomPlacement=function(n,i){for(t.pTmp=this.pFirst;t.pTmp!=null&&t.pTmp!==i;)t.pTmp.fX=Math.random()*t.iWidth-this.iOffsetX-t.iWidth/2,t.pTmp.fY=Math.random()*t.iHeight-this.iOffsetY-t.iHeight/2,t.pTmp.fVelocityX=Math.random()*this.oAnimationInParams.fMaxStartVelocity*2-this.oAnimationInParams.fMaxStartVelocity,t.pTmp.fVelocityY=Math.random()*this.oAnimationInParams.fMaxStartVelocity*2-this.oAnimationInParams.fMaxStartVelocity,t.pTmp=t.pTmp.pNext},n.prototype.fnSlideIn=function(n,i){var o,s,h,c,v,r,u,y,p,l,f,e,w,b,a,g,k,d;for(g=10,c=!1,s=!1,o=!1,h=!1,v=!0,u=0,d=t.iWidth,k=t.iHeight,n!=null&&(n.iAvgTtl!=null&&(g=n.iAvgTtl),n.bTop!=null&&(c=n.bTop),n.bLeft!=null&&(s=n.bLeft),n.bBottom!=null&&(o=n.bBottom),n.bRight!=null&&(h=n.bRight),n.bUseMinOffset!=null&&(v=n.bUseMinOffset),n.fDisplacement!=null&&(u=n.fDisplacement),n.iBaseWidth!=null&&(d=n.iBaseWidth),n.iBaseHeight!=null&&(k=n.iBaseHeight)),y=p=l=k*1,p=p/2,l=l/4,w=b=a=d*1,b=b/2,a=a/4,f=0,e=0,t.pTmp=this.pFirst;t.pTmp!=null&&t.pTmp!==i;)f=~~(Math.random()*a)+(v===!0?a:0),e=~~(Math.random()*l)+(v===!0?l:0),r=Math.atan2(e,f),t.pTmp.fX=-this.iOffsetX,t.pTmp.fY=-this.iOffsetY,c===!0&&o===!0?t.pTmp.fY+=t.fnSign(Math.random()-.5)*e*Math.sin(r):o===!0?t.pTmp.fY+=e*Math.sin(r):c===!0&&(t.pTmp.fY-=e*Math.sin(r)),(c===!0||o===!0)&&(t.pTmp.fX+=Math.random()*w*u*2-w*u),s===!0&&h===!0?t.pTmp.fX+=t.fnSign(Math.random()-.5)*f*Math.cos(r):s===!0?t.pTmp.fX-=f*Math.cos(r):h===!0&&(t.pTmp.fX+=f*Math.cos(r)),(s===!0||h===!0)&&(t.pTmp.fY+=Math.random()*y*u*2-y*u),t.pTmp.fVelocityX=Math.random()*this.oAnimationInParams.fMaxStartVelocity*2-this.oAnimationInParams.fMaxStartVelocity,t.pTmp.fVelocityY=Math.random()*this.oAnimationInParams.fMaxStartVelocity*2-this.oAnimationInParams.fMaxStartVelocity,t.pTmp=t.pTmp.pNext},n.prototype.fnImplode=function(n,i){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bTop:!0,bRight:!0,bBottom:!0,bLeft:!0,bUseMinOffset:!1,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.01,iBaseWidth:n.iBaseWidth!=null?n.iBaseWidth:t.iWidth*2,iBaseHeight:n.iBaseHeight!=null?n.iBaseHeight:t.iHeight*2},i)},n.prototype.fnSlideDoor=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bRight:!0,bLeft:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.25,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnWarpIn=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bTop:!0,bBottom:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideInTop=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bTop:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideInRight=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bRight:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideInBottom=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bBottom:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideInLeft=function(n,t){n!=null||(n={}),this.fnSlideIn({iAvgTtl:n.iAvgTtl,bLeft:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideOut=function(n,i){var o,s,h,c,v,r,u,p,w,l,b,k,a,y,d,g,f,e;for(y=10,c=!1,s=!1,o=!1,h=!1,v=!0,u=0,g=t.iWidth,d=t.iHeight,n!=null&&(n.iAvgTtl!=null&&(y=n.iAvgTtl),n.bTop!=null&&(c=n.bTop),n.bLeft!=null&&(s=n.bLeft),n.bBottom!=null&&(o=n.bBottom),n.bRight!=null&&(h=n.bRight),n.bUseMinOffset!=null&&(v=n.bUseMinOffset),n.fDisplacement!=null&&(u=n.fDisplacement),n.iBaseWidth!=null&&(g=n.iBaseWidth),n.iBaseHeight!=null&&(d=n.iBaseHeight)),p=w=l=d*1,w=w/2,l=l/4,b=k=a=g*1,k=k/2,a=a/4,f=0,e=0,t.pTmp=i!=null?i:this.pFirst;t.pTmp!=null;)f=~~(Math.random()*a)+(v===!0?a:0),e=~~(Math.random()*l)+(v===!0?l:0),r=Math.atan2(e,f),c===!0&&o===!0?t.pTmp.iGravityY+=~~(t.fnSign(t.pTmp.iGravityY+this.iOffsetY)*e*Math.sin(r)):o===!0?t.pTmp.iGravityY+=~~(e*Math.sin(r)):c===!0&&(t.pTmp.iGravityY-=~~(e*Math.sin(r))),(c===!0||o===!0)&&(t.pTmp.iGravityX+=~~(Math.random()*b*u*2-b*u)),s===!0&&h===!0?t.pTmp.iGravityX+=~~(t.fnSign(t.pTmp.iGravityX+this.iOffsetX)*f*Math.cos(r)):s===!0?t.pTmp.iGravityX-=~~(f*Math.cos(r)):h===!0&&(t.pTmp.iGravityX+=~~(f*Math.cos(r))),(s===!0||h===!0)&&(t.pTmp.iGravityY+=~~(Math.random()*p*u*2-p*u)),t.pTmp.iTtl=~~(Math.random()*y+y/2),t.pTmp=t.pTmp.pNext},n.prototype.fnExplode=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bTop:!0,bRight:!0,bBottom:!0,bLeft:!0,bUseMinOffset:!1,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.01,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnDoorway=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bRight:!0,bLeft:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.25,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnWarp=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bTop:!0,bBottom:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideOutTop=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bTop:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideOutRight=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bRight:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideOutBottom=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bBottom:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n.prototype.fnSlideOutLeft=function(n,t){n!=null||(n={}),this.fnSlideOut({iAvgTtl:n.iAvgTtl,bLeft:!0,fDisplacement:n.fDisplacement!=null?n.fDisplacement:.1,iBaseWidth:n.iBaseWidth,iBaseHeight:n.iBaseHeight},t)},n}(),t.ParticleListCollection=u=function(){function n(){}return n.prototype.plFirst=null,n.prototype.fnAdd=function(n,i){return t.fnSwapList(n,"pl",t.ParticleList,i,this)},n.prototype.fnRemove=function(n,i){return t.fnSwapList(n,"pl",t.ParticleList,this,i)},n.prototype.fnCreate=function(){return t.fnSwapList(t.plcDisposed.plFirst,"pl",t.ParticleList,t.plcDisposed,this)},n.prototype.fnDispose=function(n){return this.fnRemove(n,t.plcDisposed)},n.prototype.fnUpdate=function(){var n;for(t.evPreUpdate!=null&&t.evPreUpdate(),n=+new Date,t.oUpdateWorkingData.fTimeFactor=(n-t.oUpdateWorkingData.iLastUpdate)*.0625,t.oUpdateWorkingData.iLastUpdate=n,t.oUpdateWorkingData.iOffsetX=~~(t.iWidth/2),t.oUpdateWorkingData.iOffsetY=~~(t.iHeight/2),t.plTmp=this.plFirst;t.plTmp!=null;)t.plTmp.fnUpdate(),t.plTmp=t.plTmp.plNext;t.evPostUpdate!=null&&t.evPostUpdate()},n.prototype.fnRender=function(){var n;for(t.evPreRender!=null&&t.evPreRender(),n=t.ctxRender.createImageData(t.iWidth,t.iHeight),t.oRenderWorkingData.iCount=0,t.oRenderWorkingData.iOffsetX=~~(t.iWidth/2),t.oRenderWorkingData.iOffsetY=~~(t.iHeight/2),t.oRenderWorkingData.oData=n.data,t.plTmp=this.plFirst;t.plTmp!=null;)t.plTmp.fnRender(),t.plTmp=t.plTmp.plNext;n.data=t.oRenderWorkingData.oData,t.ctxRender.putImageData(n,0,0),t.evPostRender!=null&&t.evPostRender()},n}(),t.plDisposed=new t.ParticleList,t.plcDisposed=new t.ParticleListCollection,t.plcRender=new t.ParticleListCollection,t.fnInit(n)}return n.prototype.$id=document.getElementById,n.prototype.$tag=document.getElementByTagName,n.prototype.aColorDefault=[0,0,0,0],n.prototype.aColorHighlight=[0,0,0,0],n.prototype.iMouseX=-1e9,n.prototype.iMouseY=-1e9,n.prototype.iMaxWidth=0,n.prototype.iMaxHeight=0,n.prototype.iMinWidth=0,n.prototype.iMinHeight=0,n.prototype.iWidth=0,n.prototype.iHeight=0,n.prototype.iPxSize=1,n.prototype.iPxGap=0,n.prototype.iMaxFontSize=50,n.prototype.sFont="sans-serif",n.prototype.fLineSpacing=.1,n.prototype.nBody=document.body,n.prototype.nRoot=document.body,n.prototype.nCanvRender=document.createElement("canvas"),n.prototype.nCanvLoader=document.createElement("canvas"),n.prototype.evPreRender=null,n.prototype.evPostRender=null,n.prototype.evPreUpdate=null,n.prototype.evPostUpdate=null,n.prototype.evPreMouseMove=null,n.prototype.evPostMouseMove=null,n.prototype.evPreMouseOut=null,n.prototype.evPostMouseOut=null,n.prototype.evPreResize=null,n.prototype.evPostResize=null,n.prototype.iMouseForce=1e4,n.prototype.bRestless=!0,n.prototype.bIsRunning=!1,n.prototype.oRenderWorkingData={iOffsetX:0,iOffsetY:0,iMinX:0,iMinY:0,iMaxX:0,iMaxY:0,iX:0,iY:0,iIndex:0,oData:null,aColor:[0,0,0,0],iCount:0},n.prototype.oUpdateWorkingData={iOffsetX:0,iOffsetY:0,fGravityDX:0,fGravityDY:0,fGravityForce:0,fGravityAngle:0,fMouseDX:0,fMouseDY:0,fMouseForce:0,fMouseAngle:0,iLastUpdate:+new Date,fTimeFactor:+new Date},n.prototype.plTmp=null,n.prototype.pTmp=null,n.prototype.pTmpNext=null,n.prototype.fnInit=function(n){var r,u,t,f,i,e;if(t=this,n)for(f=function(i){t[i]=n[i]},u=["nRoot","iPxSize","iPxGap","iMaxWidth","iMaxHeight","iMinWidth","iMinHeight","iWidth","iHeight","iMaxFontSize","aColorDefault","aColorHighlight","bRestless","bIsRunning","evPreRender","evPostRender","evPreUpdate","evPostUpdate","evPreMouseMove","evPostMouseMove","evPreMouseOut","evPostMouseOut","sFont"],i=0,e=u.length;i<e;i++)r=u[i],n[r]!=null&&f(r);this.iMaxWidth=this.iMaxWidth<=0?1e9:this.iMaxWidth,this.iMaxHeight=this.iMaxHeight<=0?1e9:this.iMaxHeight,this.iMinWidth=this.iMinWidth<0||this.iMinWidth>this.iMaxWidth?0:this.iMinWidth,this.iMinHeight=this.iMinHeight<0||this.iMinHeight>this.iMaxHeight?0:this.iMinHeight,this.fnResize(),this.ctxRender=this.nCanvRender.getContext("2d"),this.ctxLoader=this.nCanvLoader.getContext("2d"),this.nRoot.appendChild(this.nCanvRender),this.nRoot.appendChild(this.nCanvLoader),this.nCanvLoader.style.display="none",this.fnAddEventListener(t.nCanvRender,"mousemove",function(n){return t.fnMouseMoveEvent(n)}),this.fnAddEventListener(t.nCanvRender,"mouseout",function(n){return t.fnMouseOutEvent(n)}),this.fnAddEventListener(t.nRoot,"resize",function(n){return t.fnResize(n)}),this.fnAddEventListener(window,"resize",function(n){return t.fnResize(n)}),this.bIsRunning===!0&&this.fnRequestAnimationFrame(function(){return t.fnNextFrame()})},n.prototype.fnSign=function(n){return n?n<0?-1:1:1},n.prototype.fnGetElementPosition=function(n){var i,r,t;if(i=r=0,t=typeof n=="string"?this.$id(n):n,t)for(i=t.offsetLeft,r=t.offsetTop;t.offsetParent&&t!==this.nBody;)i+=t.offsetParent.offsetLeft,r+=t.offsetParent.offsetTop,t=t.offsetParent;return{iX:i,iY:r}},n.prototype.fnResize=function(){this.evPreResize!=null&&this.evPreResize(),this.iWidth=Math.max(this.iMinWidth,Math.min(this.iMaxWidth,this.nRoot.clientWidth)),this.iHeight=Math.max(this.iMinHeight,Math.min(this.iMaxHeight,this.nRoot.clientHeight)),this.nCanvRender.width=this.iWidth,this.nCanvRender.height=this.iHeight,this.evPostResize!=null&&this.evPostResize()},n.prototype.fnMouseMoveEvent=function(n){var t;this.evPreMouseMove!=null&&this.evPreMouseMove(),t=this.fnGetElementPosition(this.nRoot),this.iMouseX=n.clientX-t.iX+document.body.scrollLeft+document.documentElement.scrollLeft,this.iMouseY=n.clientY-t.iY+document.body.scrollTop+document.documentElement.scrollTop,this.evPostMouseMove!=null&&this.evPostMouseMove()},n.prototype.fnMouseOutEvent=function(){this.evPreMouseOut!=null&&this.evPreMouseOut(),this.iMouseX=-1e9,this.iMouseY=-1e9,this.evPostMouseOut!=null&&this.evPostMouseOut()},n.prototype.fnAddEventListener=function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n["on"+t]=i},n.prototype.fnRequestAnimationFrame=function(n){var t;t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeOut(n,1e3/60)},t(n)},n.prototype.fnStartRunning=function(){var n;n=this,this.bIsRunning===!1&&(this.bIsRunning=!0,this.fnRequestAnimationFrame(function(){n.fnNextFrame()}))},n.prototype.fnStopRunning=function(){this.bIsRunning=!1},n.prototype.fnNextFrame=function(){var n;n=this,this.plcRender.fnUpdate(),this.plcRender.fnRender(),this.bIsRunning===!0&&this.fnRequestAnimationFrame(function(){n.fnNextFrame()})},n.prototype.fnSwapList=function(n,t,i,r,u){return n!=null?r[t+"First"]===n?(r[t+"First"]=n[t+"Next"],n[t+"Next"]!=null&&(n[t+"Next"][t+"Prev"]=null)):(n[t+"Prev"][t+"Next"]=n[t+"Next"],n[t+"Next"]!=null&&(n[t+"Next"][t+"Prev"]=n[t+"Prev"])):n=new i,n[t+"Next"]=u[t+"First"],u[t+"First"]!=null&&(u[t+"First"][t+"Prev"]=n),u[t+"First"]=n,n[t+"Prev"]=null,n},n.prototype.fnParticleUpdate=function(){if(this.pTmp.iTtl!=null){if(this.pTmp.iTtl<=0){this.plTmp.fnDispose(this.pTmp);return}this.pTmp.iTtl-=1,this.plTmp.bFadeOutOnTtl===!0&&(this.pTmp.aColor[3]=~~(this.pTmp.aColor[3]*(Math.atan(this.pTmp.iTtl)/(Math.PI/2))))}this.oUpdateWorkingData.fGravityDX=this.pTmp.iGravityX-this.pTmp.fX,this.oUpdateWorkingData.fGravityDY=this.pTmp.iGravityY-this.pTmp.fY,this.oUpdateWorkingData.fGravityForce=Math.sqrt(this.oUpdateWorkingData.fGravityDX*this.oUpdateWorkingData.fGravityDX+this.oUpdateWorkingData.fGravityDY*this.oUpdateWorkingData.fGravityDY)*.01+(this.bRestless===!0?Math.random()*.1-.05:0),this.oUpdateWorkingData.fGravityAngle=Math.atan2(this.oUpdateWorkingData.fGravityDY,this.oUpdateWorkingData.fGravityDX),this.bRestless===!1&&this.oUpdateWorkingData.fGravityForce<.01&&(this.pTmp.fX=this.pTmp.iGravityX+.25,this.pTmp.fY=this.pTmp.iGravityY+.25),this.oUpdateWorkingData.fMouseDX=this.pTmp.fX-this.iMouseX+this.oUpdateWorkingData.iOffsetX+this.plTmp.iOffsetX,this.oUpdateWorkingData.fMouseDY=this.pTmp.fY-this.iMouseY+this.oUpdateWorkingData.iOffsetY+this.plTmp.iOffsetY,this.oUpdateWorkingData.fMouseForce=Math.min(this.iMouseForce/(this.oUpdateWorkingData.fMouseDX*this.oUpdateWorkingData.fMouseDX+this.oUpdateWorkingData.fMouseDY*this.oUpdateWorkingData.fMouseDY),this.iMouseForce),this.oUpdateWorkingData.fMouseAngle=Math.atan2(this.oUpdateWorkingData.fMouseDY,this.oUpdateWorkingData.fMouseDX),this.pTmp.fVelocityX+=(this.oUpdateWorkingData.fGravityForce*Math.cos(this.oUpdateWorkingData.fGravityAngle)+this.oUpdateWorkingData.fMouseForce*Math.cos(this.oUpdateWorkingData.fMouseAngle))*this.oUpdateWorkingData.fTimeFactor,this.pTmp.fVelocityY+=(this.oUpdateWorkingData.fGravityForce*Math.sin(this.oUpdateWorkingData.fGravityAngle)+this.oUpdateWorkingData.fMouseForce*Math.sin(this.oUpdateWorkingData.fMouseAngle))*this.oUpdateWorkingData.fTimeFactor,this.pTmp.fVelocityX*=Math.pow(.92,this.oUpdateWorkingData.fTimeFactor),this.pTmp.fVelocityY*=Math.pow(.92,this.oUpdateWorkingData.fTimeFactor),this.pTmp.fX+=this.pTmp.fVelocityX,this.pTmp.fY+=this.pTmp.fVelocityY},n.prototype.fnParticleRender=function(){for(this.oRenderWorkingData.iMinX=~~this.pTmp.fX+this.oRenderWorkingData.iOffsetX+this.plTmp.iOffsetX,this.oRenderWorkingData.iMinY=~~this.pTmp.fY+this.oRenderWorkingData.iOffsetY+this.plTmp.iOffsetY,this.oRenderWorkingData.iMaxX=this.oRenderWorkingData.iMinX+this.iPxSize,this.oRenderWorkingData.iMaxY=this.oRenderWorkingData.iMinY+this.iPxSize,this.oRenderWorkingData.iX=this.oRenderWorkingData.iMinX;this.oRenderWorkingData.iX<this.oRenderWorkingData.iMaxX;){if(this.oRenderWorkingData.iY=this.oRenderWorkingData.iMinY,this.oRenderWorkingData.iX>=0&&this.oRenderWorkingData.iX<this.iWidth)while(this.oRenderWorkingData.iY<this.oRenderWorkingData.iMaxY)this.oRenderWorkingData.iY>=0&&this.oRenderWorkingData.iY<this.iHeight&&(this.oRenderWorkingData.iIndex=(this.oRenderWorkingData.iY*this.iWidth+this.oRenderWorkingData.iX)*4,this.oRenderWorkingData.aColor!=null?(this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+0]=this.oRenderWorkingData.aColor[0],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+1]=this.oRenderWorkingData.aColor[1],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+2]=this.oRenderWorkingData.aColor[2],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+3]=this.oRenderWorkingData.aColor[3]):(this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+0]=this.pTmp.aColor[0],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+1]=this.pTmp.aColor[1],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+2]=this.pTmp.aColor[2],this.oRenderWorkingData.oData[this.oRenderWorkingData.iIndex+3]=this.pTmp.aColor[3])),this.oRenderWorkingData.iY+=1;this.oRenderWorkingData.iX+=1}this.oRenderWorkingData.iCount++},n.prototype.fnParticleInit=function(n,t,i,r,u){return n.iTtl=null,u.bKeepOldPosition!==!0&&(n.fX=t,n.fY=i),n.iGravityX=t,n.iGravityY=i,n.fVelocityX=0,n.fVelocityY=0,n.aColor=r,n},n}(),window.ParticleSystem=n}).call(this)
